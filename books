import csv
import sqlite3 as sq3


'''with open('books.csv', 'w') as file:
    file.write('author,book\n')
    file.write('J R R Tolkien,The Hobbit\n')
    file.write('Lynne Truss,"Eats, Shoots & Leaves"\n')
    file.close()

with open('books.csv') as file:
    books = list(csv.DictReader(file))
    for book in books:
        print(book)
    file.close()

print('\n\n')'''

with open('books2.csv', 'w') as file:
    file.write('title,author,year\n')
    file.write('The Weirdstone of Brisingamen,Alan Garner,1960\n')
    file.write('Perdido Street Station,China Mi√©ville,2000\n')
    file.write('Thud!,Terry Pratchett,2005\n')
    file.write('The Spellman Files,Lisa Lutz,2007\n')
    file.write('Small Gods,Terry Pratchett,1992\n')
    

#with open('books2.csv') as file:
#    books = list(csv.DictReader(file))
#    for book in books:
#        print(book)
#    file.close()

conn = sq3.connect('books.db')
curs = conn.cursor()

curs.execute('''CREATE TABLE IF NOT EXISTS books
            (id INTEGER PRIMARY KEY,
            title TEXT,
            author TEXT,
            year INTEGER)''')
conn.commit()

with open('books2.csv') as file:
    ins = '''INSERT INTO books (title, author, year) VALUES(?, ?, ?)'''

    for line in file:
        curs.execute(ins, line.split(','))


curs.execute('''DELETE FROM books WHERE id = "1"''')
curs.execute('''SELECT * FROM books''')
table = curs.fetchall()
print(table)
curs.execute('''SELECT author FROM books ORDER BY author''')
authors = curs.fetchall()
print(authors)
file.close()